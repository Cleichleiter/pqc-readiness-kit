      - name: PowerShell syntax check (parse only)
        run: |
          pwsh -NoProfile -Command "
            $tokens = $null
            $parseErrors = $null
            [System.Management.Automation.Language.Parser]::ParseFile(
              'scripts/pwsh/Invoke-CryptoInventory.ps1',
              [ref]$tokens,
              [ref]$parseErrors
            ) | Out-Null

            if ($parseErrors -and $parseErrors.Count -gt 0) {
              $parseErrors | ForEach-Object { Write-Host $_.Message }
              throw 'PowerShell parse errors detected'
            }
          "
